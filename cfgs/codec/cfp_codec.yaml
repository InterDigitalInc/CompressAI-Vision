type: "cfp_codec"
eval_encode: "bitrate" # or "bpp"
experiment: "" # e.g. "_test_xy_margin_decay" name experiment preceded by "_"
output_dir: "${pipeline.output_dir_root}/${.type}${.experiment}/${dataset.datacatalog}/${dataset.config.dataset_name}/qp${codec.encoder_config.qp}_qpdensity${codec.encoder_config.qp_density}"
bitstream_name: "${dataset.config.dataset_name}_qp${codec.encoder_config.qp}_qpdensity${codec.encoder_config.qp_density}"

verbosity: 0

encoder_config:
  # feature channel suppression optimization
  feature_channel_suppression:
    # manual clustering
    manual_cluster: False
    # if manual_cluster is True, but no n_clusters is provided,
    # full channels will be coded
    n_clusters: {}

    min_nb_channels_for_group : 3
    # For the manual cluster and downcale are True,
    # all feture tensor will be downscaled by 2
    downscale: True

    supression_measure: "rpn" # or "mse"

    # sub configurations for suppression with "rpn" measure
    rpn:
      # minimum number of channels per group coding
      xy_margin : 0.10 # percentage
      xy_margin_decay : 0.01 # increase margin by
      coverage_thres: 0.7 # percentage
      coverage_decay: 0.98 # default

  # inter cfg
  intra_period: -1
  group_of_tensor: 32

  # qp
  qp: 8
  qp_density: 2 #  (range = [1, 5])

  layer_qp_offsets: [0, 0, 0] # layer0 has qp, next layers: layer_i qp+layer_qp_offest[i-1]

  # qp - dc
  dc_qp_offset: -60
  # max (dc_qp_density_offset) = (5 - qp_density)
  dc_qp_density_offset: 3 # has significant impact on mAP
